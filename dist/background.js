(()=>{"use strict";const e=[/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{0,256}imgur.[-a-zA-Z0-9@:%._\+~#=]{1,256}(\/)?/,/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{0,256}youtube.[-a-zA-Z0-9@:%._\+~#=]{1,256}(\/)?/,/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{0,256}reddit.[-a-zA-Z0-9@:%._\+~#=]{1,256}(\/)?/,/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{0,256}messenger.[-a-zA-Z0-9@:%._\+~#=]{1,256}(\/)?/,/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{0,256}linkedin.[-a-zA-Z0-9@:%._\+~#=]{1,256}(\/)?/,/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{0,256}news.google.[-a-zA-Z0-9@:%._\+~#=]{1,256}(\/)?/];var t=!0;chrome.storage.local.set({isBlocking:!0});var o,s=null;function i(e){var t={type:"BLOCKING_TIMESTAMP",timestamp:e};chrome.runtime.sendMessage(t)}function a(e){var t={type:"IS_BLOCKING_STATUS",isBlocking:e};chrome.runtime.sendMessage(t)}chrome.storage.local.set({blockingTimestamp:null}),chrome.tabs.onUpdated.addListener((function(o,s,i){if(i.url&&t)for(var a=0,n=e;a<n.length;a++)if(n[a].test(i.url)){chrome.tabs.remove(o,(function(){console.log("removed",o,i.url)}));break}})),chrome.runtime.onMessage.addListener((function(e){switch(e.type){case"REQ_IS_BLOCKING_STATUS":n=a,chrome.storage.local.get("isBlocking",(function(e){t=!!e.isBlocking,n(t)}));break;case"TOGGLE_IS_BLOCKING":t=e.isBlocking,chrome.storage.local.set({isBlocking:t}),a(t);break;case"REQ_BLOCKING_TIMESTAMP":console.log("BACKEND: received request for blocking timestamp",{blockingTimestamp:s}),function(e){chrome.storage.local.get("blockingTimestamp",(function(t){s=t.blockingTimestamp?t.blockingTimestamp:null,e(s)}))}(i);break;case"SET_BLOCKING_TIMESTAMP":if(console.log("BACKEND: received request to set blocking timestamp",e.timestamp),!e.timestamp)return s=e.timestamp,chrome.storage.local.set({blockingTimestamp:e.timestamp}),i(s),void(o&&clearTimeout(o));s=e.timestamp,chrome.storage.local.set({blockingTimestamp:e.timestamp}),i(s),o=setTimeout((function(){i(s=null),chrome.storage.local.set({blockingTimestamp:s}),a(t=!0),chrome.storage.local.set({isBlocking:t}),console.log("BACKEND: in set timeout, setting to null")}),new Date(e.timestamp).getTime()-Date.now())}var n}))})();
//# sourceMappingURL=background.js.map